# pl.ul <- ggplot(data.frame(Y = skewed.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
pl.ll <- ggplot(data.frame(Y = bimodal.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
# est1 <- optim(rep(77,4), fn = ofn, gr = ogr, thetas = skewed.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
# skewed.rdc <- rdc(n, mean = 0, sd = 1, phi = est1$par)
# pl.ur <- pl.ul + stat_function(fun = ddc,
#                                args = list(mean = 0,
#                                            sd = 1,
#                                            phi = est1$par),
#                                colour = 'blue')
est2 <- optim(rep(77,8), fn = ofn, gr = ogr, thetas = bimodal.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
est2$par
(pl.lr <- pl.ll + stat_function(fun = ddc,
args = list(mean = 0,
sd = 1,
# phi = unlist(est2[c('p1','p2','p3','p4')])),
phi = est2$par),
colour = 'blue'))
n <- 10000
# skewed.woodslin <- c(rnorm(n*.9, mean = -.25, sd = 0.61), rnorm(n*.1, mean = 2.19, sd = 1.04))
bimodal.woodslin <- c(rnorm(n*.6, mean = -.70, sd = .50), rnorm(n*.4, mean = 1.05, sd = .54))
# pl.ul <- ggplot(data.frame(Y = skewed.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
pl.ll <- ggplot(data.frame(Y = bimodal.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
# est1 <- optim(rep(77,4), fn = ofn, gr = ogr, thetas = skewed.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
# skewed.rdc <- rdc(n, mean = 0, sd = 1, phi = est1$par)
# pl.ur <- pl.ul + stat_function(fun = ddc,
#                                args = list(mean = 0,
#                                            sd = 1,
#                                            phi = est1$par),
#                                colour = 'blue')
est2 <- optim(rep(77,8), fn = ofn, gr = ogr, thetas = bimodal.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
est2$par
(pl.lr <- pl.ll + stat_function(fun = ddc,
args = list(mean = 0,
sd = 1,
# phi = unlist(est2[c('p1','p2','p3','p4')])),
phi = est2$par),
colour = 'blue'))
n <- 10000
# skewed.woodslin <- c(rnorm(n*.9, mean = -.25, sd = 0.61), rnorm(n*.1, mean = 2.19, sd = 1.04))
bimodal.woodslin <- c(rnorm(n*.6, mean = -.70, sd = .50), rnorm(n*.4, mean = 1.05, sd = .54))
# pl.ul <- ggplot(data.frame(Y = skewed.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
pl.ll <- ggplot(data.frame(Y = bimodal.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
# est1 <- optim(rep(77,4), fn = ofn, gr = ogr, thetas = skewed.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
# skewed.rdc <- rdc(n, mean = 0, sd = 1, phi = est1$par)
# pl.ur <- pl.ul + stat_function(fun = ddc,
#                                args = list(mean = 0,
#                                            sd = 1,
#                                            phi = est1$par),
#                                colour = 'blue')
est2 <- optim(rep(77,8), fn = ofn, gr = ogr, thetas = bimodal.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
est2$par
(pl.lr <- pl.ll + stat_function(fun = ddc,
args = list(mean = 0,
sd = 1,
# phi = unlist(est2[c('p1','p2','p3','p4')])),
phi = est2$par),
colour = 'blue'))
n <- 10000
# skewed.woodslin <- c(rnorm(n*.9, mean = -.25, sd = 0.61), rnorm(n*.1, mean = 2.19, sd = 1.04))
bimodal.woodslin <- c(rnorm(n*.6, mean = -.70, sd = .50), rnorm(n*.4, mean = 1.05, sd = .54))
# pl.ul <- ggplot(data.frame(Y = skewed.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
pl.ll <- ggplot(data.frame(Y = bimodal.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
# est1 <- optim(rep(77,4), fn = ofn, gr = ogr, thetas = skewed.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
# skewed.rdc <- rdc(n, mean = 0, sd = 1, phi = est1$par)
# pl.ur <- pl.ul + stat_function(fun = ddc,
#                                args = list(mean = 0,
#                                            sd = 1,
#                                            phi = est1$par),
#                                colour = 'blue')
est2 <- optim(rep(77,8), fn = ofn, gr = ogr, thetas = bimodal.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
est2$par
(pl.lr <- pl.ll + stat_function(fun = ddc,
args = list(mean = 0,
sd = 1,
# phi = unlist(est2[c('p1','p2','p3','p4')])),
phi = est2$par),
colour = 'blue'))
n <- 10000
# skewed.woodslin <- c(rnorm(n*.9, mean = -.25, sd = 0.61), rnorm(n*.1, mean = 2.19, sd = 1.04))
bimodal.woodslin <- c(rnorm(n*.6, mean = -.70, sd = .50), rnorm(n*.4, mean = 1.05, sd = .54))
# pl.ul <- ggplot(data.frame(Y = skewed.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
pl.ll <- ggplot(data.frame(Y = bimodal.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
# est1 <- optim(rep(77,4), fn = ofn, gr = ogr, thetas = skewed.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
# skewed.rdc <- rdc(n, mean = 0, sd = 1, phi = est1$par)
# pl.ur <- pl.ul + stat_function(fun = ddc,
#                                args = list(mean = 0,
#                                            sd = 1,
#                                            phi = est1$par),
#                                colour = 'blue')
est2 <- optim(rep(77,8), fn = ofn, gr = ogr, thetas = bimodal.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
est2$par
(pl.lr <- pl.ll + stat_function(fun = ddc,
args = list(mean = 0,
sd = 1,
# phi = unlist(est2[c('p1','p2','p3','p4')])),
phi = est2$par),
colour = 'blue'))
n <- 10000
# skewed.woodslin <- c(rnorm(n*.9, mean = -.25, sd = 0.61), rnorm(n*.1, mean = 2.19, sd = 1.04))
bimodal.woodslin <- c(rnorm(n*.6, mean = -.70, sd = .50), rnorm(n*.4, mean = 1.05, sd = .54))
# pl.ul <- ggplot(data.frame(Y = skewed.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
pl.ll <- ggplot(data.frame(Y = bimodal.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
# est1 <- optim(rep(77,4), fn = ofn, gr = ogr, thetas = skewed.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
# skewed.rdc <- rdc(n, mean = 0, sd = 1, phi = est1$par)
# pl.ur <- pl.ul + stat_function(fun = ddc,
#                                args = list(mean = 0,
#                                            sd = 1,
#                                            phi = est1$par),
#                                colour = 'blue')
est2 <- optim(rep(77,8), fn = ofn, gr = ogr, thetas = bimodal.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
est2$par
(pl.lr <- pl.ll + stat_function(fun = ddc,
args = list(mean = 0,
sd = 1,
# phi = unlist(est2[c('p1','p2','p3','p4')])),
phi = est2$par),
colour = 'blue'))
n <- 10000
# skewed.woodslin <- c(rnorm(n*.9, mean = -.25, sd = 0.61), rnorm(n*.1, mean = 2.19, sd = 1.04))
bimodal.woodslin <- c(rnorm(n*.6, mean = -.70, sd = .50), rnorm(n*.4, mean = 1.05, sd = .54))
# pl.ul <- ggplot(data.frame(Y = skewed.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
pl.ll <- ggplot(data.frame(Y = bimodal.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
# est1 <- optim(rep(77,4), fn = ofn, gr = ogr, thetas = skewed.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
# skewed.rdc <- rdc(n, mean = 0, sd = 1, phi = est1$par)
# pl.ur <- pl.ul + stat_function(fun = ddc,
#                                args = list(mean = 0,
#                                            sd = 1,
#                                            phi = est1$par),
#                                colour = 'blue')
est2 <- optim(rep(77,8), fn = ofn, gr = ogr, thetas = bimodal.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
est2$par
(pl.lr <- pl.ll + stat_function(fun = ddc,
args = list(mean = 0,
sd = 1,
# phi = unlist(est2[c('p1','p2','p3','p4')])),
phi = est2$par),
colour = 'blue'))
est2 <- optim(rep(77,8), fn = ofn, gr = ogr, thetas = bimodal.woodslin, mean = 0, sd = 2, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
est2$par
(pl.lr <- pl.ll + stat_function(fun = ddc,
args = list(mean = 0,
sd = 1,
# phi = unlist(est2[c('p1','p2','p3','p4')])),
phi = est2$par),
colour = 'blue'))
est2 <- optim(rep(77,8), fn = ofn, gr = ogr, thetas = bimodal.woodslin, mean = 0, sd = .5, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
est2$par
(pl.lr <- pl.ll + stat_function(fun = ddc,
args = list(mean = 0,
sd = 1,
# phi = unlist(est2[c('p1','p2','p3','p4')])),
phi = est2$par),
colour = 'blue'))
est2 <- optim(rep(77,8), fn = ofn, gr = ogr, thetas = bimodal.woodslin, mean = 0, sd = 2.5, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
est2$par
(pl.lr <- pl.ll + stat_function(fun = ddc,
args = list(mean = 0,
sd = 1,
# phi = unlist(est2[c('p1','p2','p3','p4')])),
phi = est2$par),
colour = 'blue'))
est2 <- optim(rep(77,8), fn = ofn, gr = ogr, thetas = bimodal.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
est2$par
(pl.lr <- pl.ll + stat_function(fun = ddc,
args = list(mean = 0,
sd = 1,
# phi = unlist(est2[c('p1','p2','p3','p4')])),
phi = est2$par),
colour = 'blue'))
hist(bimodal.woodslin)
set.seed(1)
n <- 10000
# skewed.woodslin <- c(rnorm(n*.9, mean = -.25, sd = 0.61), rnorm(n*.1, mean = 2.19, sd = 1.04))
bimodal.woodslin <- c(rnorm(n*.6, mean = -.70, sd = .50), rnorm(n*.4, mean = 1.05, sd = .54))
hist(bimodal.woodslin)
set.seed(1)
n <- 10000
skewed.woodslin <- c(rnorm(n*.9, mean = -.25, sd = 0.61), rnorm(n*.1, mean = 2.19, sd = 1.04))
bimodal.woodslin <- c(rnorm(n*.6, mean = -.70, sd = .50), rnorm(n*.4, mean = 1.05, sd = .54))
pl.ul <- ggplot(data.frame(Y = skewed.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
pl.ll <- ggplot(data.frame(Y = bimodal.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
est1 <- optim(rep(77,4), fn = ofn, gr = ogr, thetas = skewed.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
skewed.rdc <- rdc(n, mean = 0, sd = 1, phi = est1$par)
pl.ur <- pl.ul + stat_function(fun = ddc,
args = list(mean = 0,
sd = 1,
phi = est1$par),
colour = 'blue')
est2 <- optim(rep(77,8), fn = ofn, gr = ogr, thetas = bimodal.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
est2$par
(pl.lr <- pl.ll + stat_function(fun = ddc,
args = list(mean = 0,
sd = 1,
# phi = unlist(est2[c('p1','p2','p3','p4')])),
phi = est2$par),
colour = 'blue'))
set.seed(1)
n <- 10000
skewed.woodslin <- c(rnorm(n*.9, mean = -.25, sd = 0.61), rnorm(n*.1, mean = 2.19, sd = 1.04))
bimodal.woodslin <- c(rnorm(n*.6, mean = -.70, sd = .50), rnorm(n*.4, mean = 1.05, sd = .54))
pl.ul <- ggplot(data.frame(Y = skewed.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
pl.ll <- ggplot(data.frame(Y = bimodal.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
est1 <- optim(rep(77,4), fn = ofn, gr = ogr, thetas = skewed.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
skewed.rdc <- rdc(n, mean = 0, sd = 1, phi = est1$par)
pl.ur <- pl.ul + stat_function(fun = ddc,
args = list(mean = 0,
sd = 1,
phi = est1$par),
colour = 'blue')
est2 <- optim(rep(77,8), fn = ofn, gr = ogr, thetas = bimodal.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
est2$par
(pl.lr <- pl.ll + stat_function(fun = ddc,
args = list(mean = 0,
sd = 1,
# phi = unlist(est2[c('p1','p2','p3','p4')])),
phi = est2$par),
colour = 'blue'))
set.seed(2)
n <- 10000
skewed.woodslin <- c(rnorm(n*.9, mean = -.25, sd = 0.61), rnorm(n*.1, mean = 2.19, sd = 1.04))
bimodal.woodslin <- c(rnorm(n*.6, mean = -.70, sd = .50), rnorm(n*.4, mean = 1.05, sd = .54))
pl.ul <- ggplot(data.frame(Y = skewed.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
pl.ll <- ggplot(data.frame(Y = bimodal.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
est1 <- optim(rep(77,4), fn = ofn, gr = ogr, thetas = skewed.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
skewed.rdc <- rdc(n, mean = 0, sd = 1, phi = est1$par)
pl.ur <- pl.ul + stat_function(fun = ddc,
args = list(mean = 0,
sd = 1,
phi = est1$par),
colour = 'blue')
est2 <- optim(rep(77,8), fn = ofn, gr = ogr, thetas = bimodal.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
est2$par
(pl.lr <- pl.ll + stat_function(fun = ddc,
args = list(mean = 0,
sd = 1,
# phi = unlist(est2[c('p1','p2','p3','p4')])),
phi = est2$par),
colour = 'blue'))
set.seed(5)
n <- 10000
skewed.woodslin <- c(rnorm(n*.9, mean = -.25, sd = 0.61), rnorm(n*.1, mean = 2.19, sd = 1.04))
bimodal.woodslin <- c(rnorm(n*.6, mean = -.70, sd = .50), rnorm(n*.4, mean = 1.05, sd = .54))
pl.ul <- ggplot(data.frame(Y = skewed.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
pl.ll <- ggplot(data.frame(Y = bimodal.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
est1 <- optim(rep(77,4), fn = ofn, gr = ogr, thetas = skewed.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
skewed.rdc <- rdc(n, mean = 0, sd = 1, phi = est1$par)
pl.ur <- pl.ul + stat_function(fun = ddc,
args = list(mean = 0,
sd = 1,
phi = est1$par),
colour = 'blue')
est2 <- optim(rep(77,8), fn = ofn, gr = ogr, thetas = bimodal.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
est2$par
(pl.lr <- pl.ll + stat_function(fun = ddc,
args = list(mean = 0,
sd = 1,
# phi = unlist(est2[c('p1','p2','p3','p4')])),
phi = est2$par),
colour = 'blue'))
set.seed(100)
n <- 10000
skewed.woodslin <- c(rnorm(n*.9, mean = -.25, sd = 0.61), rnorm(n*.1, mean = 2.19, sd = 1.04))
bimodal.woodslin <- c(rnorm(n*.6, mean = -.70, sd = .50), rnorm(n*.4, mean = 1.05, sd = .54))
pl.ul <- ggplot(data.frame(Y = skewed.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
pl.ll <- ggplot(data.frame(Y = bimodal.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
est1 <- optim(rep(77,4), fn = ofn, gr = ogr, thetas = skewed.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
skewed.rdc <- rdc(n, mean = 0, sd = 1, phi = est1$par)
pl.ur <- pl.ul + stat_function(fun = ddc,
args = list(mean = 0,
sd = 1,
phi = est1$par),
colour = 'blue')
est2 <- optim(rep(77,8), fn = ofn, gr = ogr, thetas = bimodal.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
est2$par
(pl.lr <- pl.ll + stat_function(fun = ddc,
args = list(mean = 0,
sd = 1,
# phi = unlist(est2[c('p1','p2','p3','p4')])),
phi = est2$par),
colour = 'blue'))
set.seed(1)
n <- 10000
bimodal.woodslin <- c(rnorm(n*.6, mean = -.70, sd = .50), rnorm(n*.4, mean = 1.05, sd = .54))
skewed.woodslin <- c(rnorm(n*.9, mean = -.25, sd = 0.61), rnorm(n*.1, mean = 2.19, sd = 1.04))
pl.ul <- ggplot(data.frame(Y = skewed.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
pl.ll <- ggplot(data.frame(Y = bimodal.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
est1 <- optim(rep(77,4), fn = ofn, gr = ogr, thetas = skewed.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
skewed.rdc <- rdc(n, mean = 0, sd = 1, phi = est1$par)
pl.ur <- pl.ul + stat_function(fun = ddc,
args = list(mean = 0,
sd = 1,
phi = est1$par),
colour = 'blue')
est2 <- optim(rep(77,8), fn = ofn, gr = ogr, thetas = bimodal.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
est2$par
(pl.lr <- pl.ll + stat_function(fun = ddc,
args = list(mean = 0,
sd = 1,
# phi = unlist(est2[c('p1','p2','p3','p4')])),
phi = est2$par),
colour = 'blue'))
pl.ur
set.seed(10)
n <- 10000
bimodal.woodslin <- c(rnorm(n*.6, mean = -.70, sd = .50), rnorm(n*.4, mean = 1.05, sd = .54))
skewed.woodslin <- c(rnorm(n*.9, mean = -.25, sd = 0.61), rnorm(n*.1, mean = 2.19, sd = 1.04))
pl.ul <- ggplot(data.frame(Y = skewed.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
pl.ll <- ggplot(data.frame(Y = bimodal.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
est1 <- optim(rep(77,4), fn = ofn, gr = ogr, thetas = skewed.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
skewed.rdc <- rdc(n, mean = 0, sd = 1, phi = est1$par)
pl.ur <- pl.ul + stat_function(fun = ddc,
args = list(mean = 0,
sd = 1,
phi = est1$par),
colour = 'blue')
est2 <- optim(rep(77,8), fn = ofn, gr = ogr, thetas = bimodal.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
est2$par
(pl.lr <- pl.ll + stat_function(fun = ddc,
args = list(mean = 0,
sd = 1,
# phi = unlist(est2[c('p1','p2','p3','p4')])),
phi = est2$par),
colour = 'blue'))
set.seed(10)
n <- 10000
skewed.woodslin <- c(rnorm(n*.9, mean = -.25, sd = 0.61), rnorm(n*.1, mean = 2.19, sd = 1.04))
bimodal.woodslin <- c(rnorm(n*.6, mean = -.70, sd = .50), rnorm(n*.4, mean = 1.05, sd = .54))
pl.ul <- ggplot(data.frame(Y = skewed.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
pl.ll <- ggplot(data.frame(Y = bimodal.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
est1 <- optim(rep(77,4), fn = ofn, gr = ogr, thetas = skewed.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
skewed.rdc <- rdc(n, mean = 0, sd = 1, phi = est1$par)
pl.ur <- pl.ul + stat_function(fun = ddc,
args = list(mean = 0,
sd = 1,
phi = est1$par),
colour = 'blue')
est2 <- optim(rep(77,8), fn = ofn, gr = ogr, thetas = bimodal.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
est2$par
(pl.lr <- pl.ll + stat_function(fun = ddc,
args = list(mean = 0,
sd = 1,
# phi = unlist(est2[c('p1','p2','p3','p4')])),
phi = est2$par),
colour = 'blue'))
pl.ur
set.seed(10)
n <- 10000
skewed.woodslin <- c(rnorm(n*.9, mean = -.25, sd = 0.61), rnorm(n*.1, mean = 2.19, sd = 1.04))
bimodal.woodslin <- c(rnorm(n*.6, mean = -.70, sd = .50), rnorm(n*.4, mean = 1.05, sd = .54))
pl.ul <- ggplot(data.frame(Y = skewed.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
pl.ll <- ggplot(data.frame(Y = bimodal.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
est1 <- optim(rep(77,4), fn = ofn, gr = ogr, thetas = skewed.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
skewed.rdc <- rdc(n, mean = 0, sd = 1, phi = est1$par)
pl.ur <- pl.ul + stat_function(fun = ddc,
args = list(mean = 0,
sd = 1,
phi = est1$par),
colour = 'blue')
est2 <- optim(rep(77,8), fn = ofn, gr = ogr, thetas = bimodal.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
est2$par
(pl.lr <- pl.ll + stat_function(fun = ddc,
args = list(mean = 0,
sd = 1,
# phi = unlist(est2[c('p1','p2','p3','p4')])),
phi = est2$par),
colour = 'blue'))
pl.ur
set.seed(10)
n <- 10000
skewed.woodslin <- c(rnorm(n*.9, mean = -.25, sd = 0.61), rnorm(n*.1, mean = 2.19, sd = 1.04))
bimodal.woodslin <- c(rnorm(n*.6, mean = -.70, sd = .50), rnorm(n*.4, mean = 1.05, sd = .54))
pl.ul <- ggplot(data.frame(Y = skewed.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
pl.ll <- ggplot(data.frame(Y = bimodal.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
est1 <- optim(rep(77,4), fn = ofn, gr = ogr, thetas = skewed.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
skewed.rdc <- rdc(n, mean = 0, sd = 1, phi = est1$par)
pl.ur <- pl.ul + stat_function(fun = ddc,
args = list(mean = 0,
sd = 1,
phi = est1$par),
colour = 'blue')
pl.ur
devtools::load_all(".")
set.seed(100)
bimodal.woodslin <- c(rnorm(n*.6, mean = -.70, sd = .50), rnorm(n*.4, mean = 1.05, sd = .54))
pl.ll <- ggplot(data.frame(Y = bimodal.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
est2 <- optim(rep(77,8), fn = ofn, gr = ogr, thetas = bimodal.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
pl.lr <- pl.ll + stat_function(fun = ddc,
args = list(mean = 0,
sd = 1,
phi = est2$par),
colour = 'blue')
pl.lr
set.seed(1000)
bimodal.woodslin <- c(rnorm(n*.6, mean = -.70, sd = .50), rnorm(n*.4, mean = 1.05, sd = .54))
pl.ll <- ggplot(data.frame(Y = bimodal.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
est2 <- optim(rep(77,8), fn = ofn, gr = ogr, thetas = bimodal.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
pl.lr <- pl.ll + stat_function(fun = ddc,
args = list(mean = 0,
sd = 1,
phi = est2$par),
colour = 'blue')
pl.lr
set.seed(10000)
bimodal.woodslin <- c(rnorm(n*.6, mean = -.70, sd = .50), rnorm(n*.4, mean = 1.05, sd = .54))
pl.ll <- ggplot(data.frame(Y = bimodal.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
est2 <- optim(rep(77,8), fn = ofn, gr = ogr, thetas = bimodal.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
est2 <- optim(rep(77,8), fn = ofn, gr = ogr, thetas = bimodal.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
pl.lr <- pl.ll + stat_function(fun = ddc,
args = list(mean = 0,
sd = 1,
phi = est2$par),
colour = 'blue')
pl.lr
set.seed(10)
n <- 10000
skewed.woodslin <- c(rnorm(n*.9, mean = -.25, sd = 0.61), rnorm(n*.1, mean = 2.19, sd = 1.04))
bimodal.woodslin <- c(rnorm(n*.6, mean = -.70, sd = .50), rnorm(n*.4, mean = 1.05, sd = .54))
pl.ul <- ggplot(data.frame(Y = skewed.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
pl.ll <- ggplot(data.frame(Y = bimodal.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
est1 <- optim(rep(77,4), fn = ofn, gr = ogr, thetas = skewed.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
est2 <- optim(rep(77,8), fn = ofn, gr = ogr, thetas = bimodal.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
est2 <- optim(rep(77,8), fn = ofn, gr = ogr, thetas = bimodal.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
est2$par
(pl.lr <- pl.ll + stat_function(fun = ddc,
args = list(mean = 0,
sd = 1,
# phi = unlist(est2[c('p1','p2','p3','p4')])),
phi = est2$par),
colour = 'blue'))
est2 <- optim(rep(77,8), fn = ofn, gr = ogr, thetas = bimodal.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
est2$par
set.seed(10)
n <- 10000
skewed.woodslin <- c(rnorm(n*.9, mean = -.25, sd = 0.61), rnorm(n*.1, mean = 2.19, sd = 1.04))
.Random.seed
set.seed(403)
bimodal.woodslin <- c(rnorm(n*.6, mean = -.70, sd = .50), rnorm(n*.4, mean = 1.05, sd = .54))
pl.ll <- ggplot(data.frame(Y = bimodal.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
est2 <- optim(rep(77,8), fn = ofn, gr = ogr, thetas = bimodal.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
pl.lr <- pl.ll + stat_function(fun = ddc,
args = list(mean = 0,
sd = 1,
phi = est2$par),
colour = 'blue')
plot_grid(pl.ul, pl.ur, pl.ll, pl.lr)
set.seed(10)
n <- 10000
skewed.woodslin <- c(rnorm(n*.9, mean = -.25, sd = 0.61), rnorm(n*.1, mean = 2.19, sd = 1.04))
.Random.seed
.Random.seed
set.seed(102)
.Random.seed
set.seed(102)
.Random.seed
set.seed(32)
bimodal.woodslin <- c(rnorm(n*.6, mean = -.70, sd = .50), rnorm(n*.4, mean = 1.05, sd = .54))
pl.ll <- ggplot(data.frame(Y = bimodal.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
est2 <- optim(rep(77,8), fn = ofn, gr = ogr, thetas = bimodal.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
est2 <- optim(rep(77,8), fn = ofn, gr = ogr, thetas = bimodal.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
est2$par
(pl.lr <- pl.ll + stat_function(fun = ddc,
args = list(mean = 0,
sd = 1,
# phi = unlist(est2[c('p1','p2','p3','p4')])),
phi = est2$par),
colour = 'blue'))
set.seed(10)
.Random.seed
set.seed(-334963450)
bimodal.woodslin <- c(rnorm(n*.6, mean = -.70, sd = .50), rnorm(n*.4, mean = 1.05, sd = .54))
est2 <- optim(rep(77,8), fn = ofn, gr = ogr, thetas = bimodal.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
est2 <- optim(rep(77,8), fn = ofn, gr = ogr, thetas = bimodal.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
est2$par
(pl.lr <- pl.ll + stat_function(fun = ddc,
args = list(mean = 0,
sd = 1,
# phi = unlist(est2[c('p1','p2','p3','p4')])),
phi = est2$par),
colour = 'blue'))
set.seed(10)
n <- 10000
skewed.woodslin <- c(rnorm(n*.9, mean = -.25, sd = 0.61), rnorm(n*.1, mean = 2.19, sd = 1.04))
save(.Random.seed, file = "bimseed.Rdata")
load(bimseed.Rdata)
load('bimseed.Rdata')
load("/home/oguzhan/Documents/PhD/phd-docs/davidRian/bimseed.Rdata")
.Random.seed
load("bimseed.Rdata")
r
res
asd <- plot_grid(pl.lr, pl.ur)
asd
for (i in 1:r) {
skewed.woodslin <- c(rnorm(n*.9, mean = -.25, sd = 0.61), rnorm(n*.1, mean = 2.19, sd = 1.04))
bimodal.woodslin <- c(rnorm(n*.6, mean = -.70, sd = .50), rnorm(n*.4, mean = 1.05, sd = .54))
pl.ul <- ggplot(data.frame(Y = skewed.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
pl.ll <- ggplot(data.frame(Y = bimodal.woodslin)) + geom_histogram(aes(x=Y, y = ..density..), binwidth = 0.05) + xlim(c(-6, 6))
est1 <- optim(rep(77,4), fn = ofn, gr = ogr, thetas = skewed.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
skewed.rdc <- rdc(n, mean = 0, sd = 1, phi = est1$par)
(pl.ur <- pl.ul + stat_function(fun = ddc,
args = list(mean = 0,
sd = 1,
phi = est1$par),
colour = 'blue'))
est2 <- optim(rep(77,8), fn = ofn, gr = ogr, thetas = bimodal.woodslin, mean = 0, sd = 1, control = list(fnscale = -1, trace = 0), method = "L-BFGS-B", lower = -89.99, upper = 90)
(pl.lr <- pl.ll + stat_function(fun = ddc,
args = list(mean = 0,
sd = 1,
phi = est2$par),
colour = 'blue'))
res[[i]] <- plot_grid(pl.ur, pl.lr)
}
